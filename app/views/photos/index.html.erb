<style>
  .photo-image {
    aspect-ratio: 1.7/1.6;
    object-fit: cover;
  }
</style>

<div class="container px-md-5">
  <h4 class="text-center text-white pt-md-5 pt-3 caudex-bold">PHOTOS</h4>
  <div class="row row-cols-xl-3 row-cols-md-2 row-cols-1 pt-md-5 pt-3">
    <% @photos.each do |photo| %>
      <div class="col mt-4 text-center">
        <% if photo.photo.attached? %>
          <img data-src="<%= url_for(photo.photo) %>" class="img-fluid news-image photo-image lazy-seq-img">
        <% end %>
      </div>
    <% end %>
  </div>
</div>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const images = Array.from(document.querySelectorAll('.lazy-seq-img'));

    function loadNextImage(index) {
      if (index >= images.length) return;

      const img = images[index];
      const src = img.getAttribute('data-src');

      if (src) {
        img.src = src;
        img.onload = () => loadNextImage(index + 1);
        img.onerror = () => loadNextImage(index + 1); // Skip failed image
      } else {
        loadNextImage(index + 1);
      }
    }

    loadNextImage(0);
  });
</script>


